# ArtificialData_Streambugs_SDMs

This repository provides the data, scripts and plots of the manuscript *["Noise, bias and data limitations: Virtual benchmarking of species distribution models’ robustness for prediction and inference"](future_link)* (submitted to *Ecological Modelling*, Nov 2025)

> *Authors:* Emma Chollet Ramampiandra (ECR), Gaspard Fragnière (GF), Andreas Scheidegger (AS), Nele Schuwirth (NS)
>
> *Correspondence:* <emma.chollet@hotmail.com>
>
> *Date:* 23.01.2026


## Overview

**Goal**: This study explores the effects of data limitations on the performance and interpretability of species distribution models (SDMs) using a "virtual ecologist" approach with an artificial dataset generated by the mechanistic model *Streambugs*. The study examines how reducing dataset size, missing predictors, and noise in the data affect four SDMs: Generalized Linear Model (GLM), Generalized Additive Model (GAM), Random Forest (RF), and Artificial Neural Network (ANN). 

**Structure of the datapackage**: Folders and files are named according to their content and order. Follow this README, and run scripts in **bold** to produce the data, plots and results.

Figure 1: Diagram representing the workflow of the study.

<img src="/00_utilities/analysis_noise_scenarios.png" width="75%">


## Data information

- The macroinvertebrate biological data (observations) come from the MIDAT database, run by info fauna CSCF (Centre Suisse de Cartographie de la Faune) & karch.
- The environmental data consists of environmental factors selected and calculated based on previous studies. They are derived from the Swiss Federal Office for the Environment (water quality monitoring data, hydrological data, hydromorphological data, land use data), the Swiss Federal Office of Topography (topographical data), and the Swiss Federal Statistical Office (population statistics). They are calculated for monitoring and synthetic sites with the help of Rosi Siber.
- The macroinvertebrate and environmental data were pre-processed in the data package *PreprocessSwissInvertebrateEnvironmentalModellingData* to obtain the input datasets used here.
- The trait (environmental preferences) datasets and information about Streambugs parameters were copied from data packages of previous studies (see A1_inputs_streambugs).


## Folders and files

### Overarching folder

Directory: *ArtificialData_Streambugs_SDMs*

| filename                    | description                                                  |
| --------------------------- | ------------------------------------------------------------ |
| **set_folders_structure.r** | **Set working directory here. Run first to create all necessary folders.** |
| README.md                   | Text file (markdown format). Description of the repository.  |
| .gitignore                  | Text file. List of folders that are not updated on the repository because too heavy (A3, B1, B2, C1). |
| figure_workflow.png         | Figure of the workflow of the study.                         |
| MapRiverBasinRegion.jpg     | Swiss map colored according to catchment delimitation used for initial taxa pools, produced by Rosi Siber. |

### 00_utilities

| filename                   | description                                                  |
| -------------------------- | ------------------------------------------------------------ |
| utilities_global.r         | Global functions that are needed in many R scripts (e.g., print plots in pdf, process inputs to plot Swiss maps, but also specific functions for processing data for Streambugs or the SDMs). |
| selected_taxa_analysis.csv | List of taxa selected for further analysis, based on previous studies or ecological interest. |
| swiss.map.gdb              | Folder. Containing files (gdb) necessary to plot Swiss map with lake and rivers. |


### A1_inputs_streambugs


| filename                                                    | description                                                  |
| :---------------------------------------------------------- | ------------------------------------------------------------ |
| databases/                                                  | Folder. DAT files containing traits information of macroinvertabrates. Various sources: tachet, freshwaterecology, aquaplus... |
| others/                                                     | Additional optional files. (parameter_input_fix.dat global parameters fixed, pdf visualization of trait prior/posterior distributions from Vermeiren et al. (2020)) |
| All_2339samples_134taxa_13envfact_ProcessedDataset.csv      | Environmental inputs (and macroinvertebrate data) for 2339 samples used to run Streambugs. Output of datapackage: *PreprocessSwissInvertebrateEnvironmentalModellingData* |
| BDM_950samples_294taxa_13envfact_ProcessedDataset.csv       | Macroinvertebrate data from BDM program (EPT at species level) for 950 samples, used to define initial taxa pool per catchment (see Figure 2). Output of datapackage: *PreprocessSwissInvertebrateEnvironmentalModellingData* |
| Synthetic_environmental_data_2024-03-19.dat                 | Environmental inputs for 95'000 artificial sampling sites in Switzerland selected based on a 2kmx2km grid and snapped to the closest river. Provided by Rosi Siber. |
| invertebrates_taxonomy_2023-08-03.dat                       | Complete taxonomy (Phylum, Class, Order, Family, Genus, Species) of all macroinvertebrates. |
| parameter_input_Reform.dat                                  | Global parameter values for Streambugs, derived from Paillex et al. (2017). Both in Delta and Lognormal distribution (takes a bit more time to be "sampled", can be changed to Delta only). Some parameters (e.g., tempmax and current intercept and curve) are modified to get stronger response to fit the purpose of this study, see **XXX**.pptx for more documentation. |
| correction_preference_traits.csv                            | List of ecological preferences corrected manually for our application to make smoother response shapes (otherwise they are sometimes multimodal). |
| T1d_BDM_CH_Tvsappestsubst_maxpost_trait_pars_2023-12-15.dat | Ecological preferences from Vermeiren et al. (2020), used to update the traits derived from the databases to get stronger responses to fit the purpose of the study. |

Figure 2: Catchment delimitation used to define initial taxa pools. Ask Rosi Siber to include this as a column when preparing input environmental data.

<img src="/00_utilities/MapRiverBasinRegion.jpg" width="75%">



### A2_scripts_streambugs


| filename                      | description                                                  |
| :---------------------------- | ------------------------------------------------------------ |
| **main_streambugs.r**         | **Set working directory here. Check carefully options at the beginning of the script (e.g., taxa selection, catchment selection, nb of sites, ICE simulation or not). Run to simulate data with Streambugs, and to produce according datasets and plots.** |
| functions_run_streambugs.r    | Script with two big functions specific to our application: 1. prepare taxa parameters and variables per catchment (mix of original functions and new updates for instance interpolation to adapt responses to our application), 2. run Streambugs per catchment. |
| startjobs_main_streambugs.txt | Text file used to start a job on the SIAM server, don't forget to set "server" to TRUE in "main_streambugs.r". |
| outputtextfile.txt            | Text file with output from the R console if script is run on server. |
| library/                      | Scripts with hard coded functions of Streambugs.             |

### A3_outputs_streambugs

Files (csv and pdf) produced by the script "main_streambugs.r". Refer to their name for their content.



**TO BE CONTINUED**

### C1_documentation

| filename                | description                                                  |
| :---------------------- | ------------------------------------------------------------ |
| figure_workflow.png     | Figure of the workflow of the study used in Figure 1.        |
| MapRiverBasinRegion.jpg | Swiss map colored according to catchment delimitation used for initial taxa pools, produced by Rosi Siber. |
|                         |                                                              |
|                         |                                                              |
|                         |                                                              |
|                         |                                                              |

## Authors contribution

NS initiated the study and acquired funding. ECR, NS and AS designed the study. ECR implemented the models and carried out the simulations and visualizations of the results with support by GF, especially for implementation of the data limitation scenarios. All authors contributed to the analysis of the results. ECR wrote the first draft of the paper and all authors contributed to revisions.

## Acknowledgement

We thank the Swiss National Science Foundation (SNSF) for funding this study (grant 310030_192503). We thank the Swiss Federal Office for the Environment (FOEN), especially Yael Schindler Wildhaber, and the info fauna CSCF & karch, especially Maxime Chèvre, for access to the data and support. We thank Rosi Siber for data preparation, and Helen Moor and Antoine Adde for helpful comments on an earlier version of the manuscript.